version: "3"

tasks:
  doc:
    desc: Watch and serve documentation (requires node)
    cmds:
      - cargo doc
      - npx live-server target/doc &
      - cargo watch -s "cargo doc --target-dir target/doc_live && cp -R target/doc_live/doc/* target/doc"

  dev:
    desc: Dev inner loop. Run tests in watch mode
    cmds:
      - cargo watch -s "cargo test {{.CLI_ARGS}}"

  refresh:
    desc: Refresh macro tests
    env:
      MACROTEST: overwrite
    cmds:
      - cargo test --test macrotest
